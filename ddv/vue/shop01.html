<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

</head>

<body>
    <div id="app">
        <h2>商品列表</h2>
        <ul>
            <li v-for="product in products" :key="product.id">
                {{ product.name}} - {{product.price}} 元
                <button @click="addToCart(product)">加入購物車</button>
            </li>

        </ul>

        <h2>購物車</h2>
        <button @click="clearCart">清空購物車</button>
        <ul>
            <li v-for="item in cart" :key="item.id">
                {{ item.name }} x {{ item.quantity }} - {{ item.price * item.quantity }} 元
                <button @click="removeFromCart(item.id)">刪除</button>
                <button @click="decreaseQuantity(item)">－</button>
                <button @click="increaseQuantity(item)">＋</button>
            </li>

        </ul>
        <h3>總金額：{{ totalPrice }} 元</h3>

    </div>

    <script>
        const { createApp, ref, computed } = Vue

        createApp({
            setup() {
                const products = ref([
                    { id: 1, name: '手機', price: 10000 },
                    { id: 2, name: '耳機', price: 3000 },
                    { id: 3, name: '電腦', price: 25000 }
                ])

                const cart = ref([])

                function addToCart(product) {
                    // 檢查購物車中是否已經有這個商品
                    const found = cart.value.find(item => item.id === product.id)
                    if (found) {
                        found.quantity++;
                    } else {
                        cart.value.push({ ...product, quantity: 1 });
                    }
                }

                function increaseQuantity(item) {
                    item.quantity++;
                }

                function decreaseQuantity(item) {
                    if (item.quantity > 1) {
                        item.quantity--;
                    } else {
                        // 如果數量減到 1 以下，可以選擇刪除商品
                        removeFromCart(item.id);
                    }
                }

                function clearCart() {
                    cart.value = []
                }

                function removeFromCart(id) {
                    cart.value = cart.value.filter(item => item.id !== id)
                }

                const totalPrice = computed(() => {
                    return cart.value.reduce((sum, item) => sum + item.price * item.quantity, 0)
                })

                return { products, cart, addToCart, totalPrice, removeFromCart, decreaseQuantity, increaseQuantity, clearCart }
            }
        }).mount('#app')



    </script>
</body>

</html>