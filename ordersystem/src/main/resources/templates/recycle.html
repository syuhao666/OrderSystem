<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>回收站</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <style>
        .main-content {
            margin-left: 0;
            padding: 20px;
        }
        @media (min-width: 768px) {
            .main-content {
                margin-left: 16.666667%;
            }
        }
        @media (min-width: 992px) {
            .main-content {
                margin-left: 16.666667%;
            }
        }
        .table th {
            background-color: #f8f9fa;
        }
        .btn-restore {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            text-decoration: none;
        }
        .btn-delete {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            text-decoration: none;
        }
        .btn-restore:hover, .btn-delete:hover {
            color: white;
            text-decoration: none;
        }
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 100;
        }
    </style>
</head>
<body>
    <!-- 側邊欄 -->
    <div th:replace="fragments/sidebar :: sidebar"></div>
    
    <!-- 主要內容區域 -->
    <div class="main-content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <h2 class="mb-4">回收站</h2>
                    
                    <!-- 返回按鈕 -->
                    <a href="/admin/products" class="btn btn-secondary mb-3">
                        <i class="bi bi-arrow-left"></i> 返回商品管理
                    </a>
                    
                    <!-- 商品列表 -->
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>商品名稱</th>
                                    <th>分類</th>
                                    <th>價格</th>
                                    <th>庫存</th>
                                    <th>狀態</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr th:each="product : ${deletedProducts.content}">
                                    <td th:text="${product.name}"></td>
                                    <td th:text="${product.category}"></td>
                                    <td th:text="${'NT$ ' + product.price}"></td>
                                    <td th:text="${product.stock}"></td>
                                    <td th:text="${product.status}"></td>
                                    <td>
                                        <a th:href="@{'/admin/product/restore/' + ${product.id}}" 
                                           class="btn-restore me-2"
                                           onclick="return confirm('確定要還原這個商品嗎？');">
                                            <i class="bi bi-arrow-clockwise"></i> 還原
                                        </a>
                                        <a th:href="@{'/admin/product/hard-delete/' + ${product.id}}"
                                           class="btn-delete"
                                           onclick="return confirm('確定要永久刪除這個商品嗎？此操作無法撤銷！');">
                                            <i class="bi bi-trash"></i> 永久刪除
                                        </a>
                                    </td>
                                </tr>
                                <tr th:if="${#lists.isEmpty(deletedProducts.content)}">
                                    <td colspan="6" class="text-center text-muted">
                                        <i class="bi bi-inbox"></i> 回收站中沒有商品
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- 分頁 -->
                    <div th:if="${deletedProducts.totalPages > 1}" class="d-flex justify-content-center">
                        <nav>
                            <ul class="pagination">
                                <!-- 上一頁 -->
                                <li class="page-item" th:classappend="${deletedProducts.first} ? 'disabled'">
                                    <a class="page-link" th:href="@{/admin/products/recycle(page=${deletedProducts.number - 1})}">
                                        <i class="bi bi-chevron-left"></i> 上一頁
                                    </a>
                                </li>
                                
                                <!-- 頁碼 -->
                                <li class="page-item" th:each="pageNum : ${#numbers.sequence(0, deletedProducts.totalPages - 1)}"
                                    th:classappend="${pageNum == deletedProducts.number} ? 'active'">
                                    <a class="page-link" th:href="@{/admin/products/recycle(page=${pageNum})}" 
                                       th:text="${pageNum + 1}"></a>
                                </li>
                                
                                <!-- 下一頁 -->
                                <li class="page-item" th:classappend="${deletedProducts.last} ? 'disabled'">
                                    <a class="page-link" th:href="@{/admin/products/recycle(page=${deletedProducts.number + 1})}">
                                        下一頁 <i class="bi bi-chevron-right"></i>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                    
                    <!-- 統計信息 -->
                    <div class="mt-3 text-muted">
                        <small>
                            <i class="bi bi-info-circle"></i>
                            共 <span th:text="${deletedProducts.totalElements}">0</span> 個商品，
                            第 <span th:text="${deletedProducts.number + 1}">1</span> 頁，
                            共 <span th:text="${deletedProducts.totalPages}">1</span> 頁
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
